<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bacteria Simulation</title>
<style>
body { font-family: Arial, sans-serif; display: flex; }
#sim { border: 1px solid #333; margin-right: 20px; }
#controls { max-width: 200px; }
</style>
</head>
<body>
<canvas id="sim" width="600" height="400"></canvas>
<div id="controls">
<h3>Parameters</h3>
<label>Grass growth rate: <input type="range" id="growth" min="0" max="1" step="0.01" value="0.1"></label>
<p>Herbivores: <span id="herbCount">0</span></p>
<p>Predators: <span id="predCount">0</span></p>
<p>Omnivores: <span id="omniCount">0</span></p>
<button id="start">Start</button>
<button id="stop">Stop</button>
</div>
<script>
class Cell {
  constructor() {
    this.grass = Math.random() < 0.5 ? 1 : 0;
  }
}
class Creature {
  constructor(type, x, y) {
    this.type = type; // 'herb','pred','omni'
    this.x = x; this.y = y;
    this.energy = 20;
  }
  move(world) {
    const dirs = [[1,0],[-1,0],[0,1],[0,-1]];
    const d = dirs[Math.floor(Math.random()*dirs.length)];
    this.x = Math.max(0, Math.min(world.width-1, this.x+d[0]));
    this.y = Math.max(0, Math.min(world.height-1, this.y+d[1]));
    this.energy -= 0.1; // life cost
  }
}
class World {
  constructor(w,h) {
    this.width=w; this.height=h;
    this.grid=[];
    for(let i=0;i<h;i++){this.grid.push([]); for(let j=0;j<w;j++){this.grid[i].push(new Cell());}}
    this.creatures=[];
  }
  step(growth) {
    // grow grass
    for(let row of this.grid) for(let cell of row) if(Math.random()<growth) cell.grass=1;
    // update creatures
    let newCreatures=[];
    for(let c of this.creatures){
      c.move(this);
      const cell=this.grid[c.y][c.x];
      if(c.type!='pred' && cell.grass>0){cell.grass=0; c.energy+=5;}
      // check eat other
      if(c.type!='herb'){
        const prey=this.creatures.find(o=>o!=c && o.x==c.x && o.y==c.y && o.type=='herb');
        if(prey){prey.energy=0; c.energy+=10;}
      }
      if(c.energy>40){ c.energy/=2; newCreatures.push(new Creature(c.type,c.x,c.y)); }
      if(c.energy>0) newCreatures.push(c);
    }
    this.creatures=newCreatures;
  }
}
const canvas=document.getElementById('sim');
const ctx=canvas.getContext('2d');
const world=new World(60,40);
for(let i=0;i<10;i++) world.creatures.push(new Creature('herb',Math.floor(Math.random()*60),Math.floor(Math.random()*40)));
for(let i=0;i<5;i++) world.creatures.push(new Creature('pred',Math.floor(Math.random()*60),Math.floor(Math.random()*40)));
for(let i=0;i<5;i++) world.creatures.push(new Creature('omni',Math.floor(Math.random()*60),Math.floor(Math.random()*40)));
let running=false;
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let y=0;y<world.height;y++){
    for(let x=0;x<world.width;x++){
      if(world.grid[y][x].grass) { ctx.fillStyle='green'; ctx.fillRect(x*10,y*10,10,10); }
    }
  }
  for(let c of world.creatures){
    ctx.fillStyle=c.type=='herb'?'blue':c.type=='pred'?'red':'purple';
    ctx.fillRect(c.x*10,c.y*10,10,10);
  }
  document.getElementById('herbCount').textContent=world.creatures.filter(c=>c.type=='herb').length;
  document.getElementById('predCount').textContent=world.creatures.filter(c=>c.type=='pred').length;
  document.getElementById('omniCount').textContent=world.creatures.filter(c=>c.type=='omni').length;
}
function loop(){
  if(running){
    world.step(parseFloat(document.getElementById('growth').value));
    draw();
    requestAnimationFrame(loop);
  }
}
document.getElementById('start').onclick=()=>{ if(!running){ running=true; loop(); } };
document.getElementById('stop').onclick=()=>{ running=false; };
draw();
</script>
</body>
</html>
